# Figures Directory

Publication-ready visualizations for the Latent Diagnostics paper.

**ALL CURRENT FIGURES USE LENGTH-CONTROLLED (RESIDUALIZED) METRICS.**

---

## Directory Structure

```
figures/
├── paper/                    # Main paper figures (8 figures, all length-controlled)
├── domain_analysis/          # Domain-specific analysis (5 figures)
├── archive/                  # Superseded/historical figures
├── *.png                     # Recent analysis figures (root level)
└── README.md                 # This file
```

---

## Main Paper Figures (`paper/`)

**Generated by:** `experiments/generate_all_figures.py`

All figures use residualized metrics (length-controlled via linear regression).

| Figure | Description | Status |
|--------|-------------|--------|
| `central_summary.png/pdf` | **MAIN FIGURE.** 8-panel comprehensive summary showing all key results | ✅ Publication-ready |
| `truthfulness_overlap.png/pdf` | Negative result: true/false statements completely overlap (d=0.05) | ✅ Publication-ready |
| `domain_distributions.png/pdf` | Histograms of residualized metrics by task domain | ✅ Publication-ready |
| `pca_clustering.png/pdf` | PCA projection showing domain clustering (length-controlled) | ✅ Publication-ready |
| `boxplots_significance.png/pdf` | Box plots per domain with effect sizes | ✅ Publication-ready |
| `length_control_comparison.png/pdf` | Before/after length control: shows N Active collapses, Influence/Concentration persist | ✅ Publication-ready |
| `detection_summary.png/pdf` | Visual summary of what topology can/cannot detect | ✅ Publication-ready |
| `correlation_heatmap.png/pdf` | Correlation matrix showing length confound on N Active | ✅ Publication-ready |

**Key Effect Sizes (LENGTH-CONTROLLED):**
- **Task Type** (Grammar vs Reasoning): d=1.08 ✓
- **Computational Complexity**: d=0.87 ✓
- **Adversarial Inputs**: d=0.8 ✓
- **Truthfulness**: d=0.05 ✗ (no signal)

---

## Domain Analysis Figures (`domain_analysis/`)

**Generated by:** `experiments/domain_figures.py`

Uses robust metrics (Influence, Concentration, Activation) but NOT all residualized yet.

| Figure | Description | Status |
|--------|-------------|--------|
| `fig1_domain_radar.png/pdf` | Radar chart: activation profile per domain | ⚠️ Raw metrics (not residualized) |
| `fig2_influence_concentration.png/pdf` | Scatter: domains cluster in Influence-Concentration space | ⚠️ Raw metrics |
| `fig3_influence_gradient.png/pdf` | Bar chart: gradient from focused (grammar) to diffuse (reasoning) | ⚠️ Raw metrics |
| `fig4_length_control.png/pdf` | Demonstrates N Active is confounded, Influence is not | ✅ Shows length relationship |
| `fig5_effect_sizes.png/pdf` | Cohen's d for each metric (raw, not residualized) | ⚠️ Raw metrics |

**Note:** These use raw Influence/Concentration (robust to length) but not formally residualized. Use `paper/` figures for length-controlled analysis.

---

## Recent Analysis Figures (Root Level)

| Figure | Generated By | Description | Date | Status |
|--------|--------------|-------------|------|--------|
| `pca_domain_clustering.png/pdf` | `experiments/pca_attribution.py` | PCA on all 9 attribution metrics (50% variance on PC1) | 2026-02-23 | ✅ Current |
| `umap_domain_clustering.png/pdf` | `experiments/pca_attribution.py` | UMAP comparison to PCA | 2026-02-23 | ✅ Current |
| `shuffle_null_distribution_mean_influence.png` | `experiments/shuffle_test.py` | Permutation test: null distribution for Influence | 2026-02-23 | ✅ Current |
| `shuffle_null_distribution_top_100_concentration.png` | `experiments/shuffle_test.py` | Permutation test: null distribution for Concentration | 2026-02-23 | ✅ Current |
| `shuffle_null_distribution_n_active.png` | `experiments/shuffle_test.py` | Permutation test: null distribution for N Active | 2026-02-23 | ✅ Current |
| `residual_kde_influence.png` | `experiments/residual_distributions.py` | KDE plot: residualized Influence by domain | 2026-02-23 | ✅ Current |
| `residual_kde_concentration.png` | `experiments/residual_distributions.py` | KDE plot: residualized Concentration by domain | 2026-02-23 | ✅ Current |

---

## Archive (`archive/`)

### VN Density Experiment (2026-02-21)

**Location:** `archive/vn-density-experiment-2026-02-21/`

These figures were from the Vector Native density validation experiment that discovered the length confound:

- `density_predictors.png`
- `feature_density_factors.png`
- `length_activation_core.png`
- `length_geometry_relationship.png`
- `vn_format_density_real.png`
- `vn_symbol_density_real.png`

**Historical significance:** This experiment revealed that the "geometric signature" for prompt injection detection was actually a length artifact (r=0.96 correlation). This discovery led to the pivot toward length-controlled analysis and the current robust findings.

**Status:** Superseded by length-controlled analysis. Archived for historical record.

---

## Regenerating Figures

### All Paper Figures (Length-Controlled)
```bash
python experiments/generate_all_figures.py
```
Outputs to `figures/paper/`

### Domain Analysis Figures
```bash
python experiments/domain_figures.py
```
Outputs to `figures/domain_analysis/`

### PCA/UMAP Attribution Analysis
```bash
python experiments/pca_attribution.py
```
Outputs to `figures/` (root)

### Shuffle Tests (Null Distribution)
```bash
python experiments/shuffle_test.py
```
Outputs to `figures/` (root)

### Residual KDE Distributions
```bash
python experiments/residual_distributions.py
```
Outputs to `figures/` (root)

---

## Key Insights from Figures

### What Length Control Revealed

**Before length control (raw metrics):**
- N Active: d=2.17 (LARGE effect)
- Mean Influence: d=3.22 (HUGE effect)
- Concentration: d=2.36 (HUGE effect)

**After length control (residualized):**
- N Active: d=0.07 (COLLAPSED - was pure length artifact)
- Mean Influence: d=1.08 (PERSISTS - genuine signal)
- Concentration: d=0.87 (PERSISTS - genuine signal)

**Conclusion:** Influence and Concentration are robust diagnostics of cognitive regime. N Active is not.

### What Topology Can Detect

✅ **WORKS:**
- Task type (grammar vs reasoning): d=1.08
- Computational complexity: d=0.87
- Adversarial input patterns: d=0.8

❌ **DOES NOT WORK:**
- Truthfulness (true vs false statements): d=0.05

---

## Figure Quality Standards

All **publication-ready** figures must:
- Use length-controlled (residualized) metrics
- Include effect sizes (Cohen's d) with clear labeling
- Use consistent color scheme (see `COLORS` dict in generation scripts)
- Export both PNG (150 dpi) and PDF formats
- Include clear axis labels and titles
- Show statistical annotations where relevant

---

## Maintenance

- **Archive outdated figures** to `archive/` with dated subdirectory
- **Never delete figures** - always archive with context
- **Update this README** when adding new figure types
- **Keep scripts documented** with clear output paths

Last updated: 2026-02-23
